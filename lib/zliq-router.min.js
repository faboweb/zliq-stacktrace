!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports["zliq-router"]=n():e["zliq-router"]=n()}(this,function(){return function(e){function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}var t={};return n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="",n(n.s=1)}([function(e,n,t){"use strict";function r(e){return function(n){var t=n.target||n.srcElement;if("A"===t.tagName){var r=t.getAttribute("href"),o=r&&r.startsWith("/"),u=r&&r.startsWith("#");if(o||u){var i=a(r),c=i.anchor,f=i.route,l=i.query;void 0===f&&(f=e.value.route),s(e,{route:f,query:l,anchor:c}),n.preventDefault()}}}}function o(){window.onpopstate=function(){},document.removeEventListener("click",v)}function u(e){v&&o(),v=r(e),document.addEventListener("click",v),window.onpopstate=function(n){if(n.state){var t=n.state,r=t.route,o=t.query;l(e,r,o)}}}function i(e,n){var t=e.router$,r=e.route;if(!t)return console.log("The Router component needs the routerState$ as attribute."),null;if(!r)return console.log("The Router component needs the route as attribute."),null;t.$("routes").map(function(e){return-1===e.indexOf(r)&&t.patch({routes:e.concat(r)})});var o=t.map(function(e){var n=e.route,t=e.routes;return-1===t.indexOf(n)?-1===t.indexOf("/404")?"/":"/404":n}),u=o.is(r).distinct();return(0,p.merge$)([u,n]).map(function(e){var n=d(e,2),t=n[0],r=n[1];return t?r:[]})}function c(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:window.location,n=(0,p.stream)({route:"",params:{},routes:["/"]});if(u(n),"/"!==e.pathname||""!==e.search){var t=a(""+(e.pathname||"")+(e.search||"")+(e.hash||"")),r=t.route,o=t.query;l(n,r,o)}return n.go=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];0<t.length&&"string"==typeof t[0]?s(n,a(t[0])):s.apply(void 0,[n].concat(t))},n}function f(){return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:"").split("&").map(function(e){return e.split("=")}).reduce(function(e,n){var t=d(n,2),r=t[0],o=t[1];return e[r]=o,e},{})}function a(e){var n=/((\/\w*)*)?(\?((\w+=\w*)(&(\w+=\w*)+)*))?(#(\w+))?/,t=n.exec(e);return{anchor:t[9],route:t[1],query:t[4]}}function l(e,n,t){e.patch({route:n||"",params:f(t)})}function s(e,n){var t=n.route,r=n.query,o=n.anchor,u=(t||"/")+(r?"?"+r:"");location.replace(u),history.pushState({anchor:o,route:t,query:r},"",t+(r?"?"+r:"?")),o&&(location.hash="#"+o),l(e,t,r)}var d=function(){function e(e,n){var t=[],r=!0,o=!1,u=void 0;try{for(var i,c=e[Symbol.iterator]();!((r=(i=c.next()).done)||(t.push(i.value),n&&t.length===n));r=!0);}catch(e){o=!0,u=e}finally{try{!r&&c.return&&c.return()}finally{if(o)throw u}}return t}return function(n,t){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return e(n,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();Object.defineProperty(n,"__esModule",{value:!0}),n.removeRouter=o,n.Router=i,n.initRouter=c;var p=t(2),v=void 0},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t(0);Object.keys(r).forEach(function(e){"default"===e||"__esModule"===e||Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})})},function(e,n,t){"use strict";e.exports=t(3)},function(e,n,t){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}var t={};return n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="",n(n.s=2)}([function(e,n,t){function o(e,n){return!(0,_.default)(e,n)}function u(e,n){e.value=n,i(e.listeners,n)}function i(e,n){e.forEach(function(e){e(n)})}function c(e,n){var t=void 0===e.value?void 0:n(e.value);return x(t)}function f(e,n){var t=c(e,n);return e.listeners.push(function(e){t(n(e))}),t}function a(e){f(e,function(e){return console.log("Stream:",e)})}function l(e,n){function t(e,n,t){var r=e(n);return r.listeners.push(t),r}var r,o=function(e){u(e)},u=c(e,function(e){return r=t(n,e,o),r.value});return e.listeners.push(function(e){r&&j(r.listeners,o),r=t(n,e,o),u(r.value)}),u}function s(e,n){var t=c(e,function(e){return n(e)?e:void 0});return e.listeners.push(function(e){n(e)&&t(e)}),t}function d(e,n){return null===e||void 0===e?null:0===n.length?e:d(e[n[0]],n.splice(1,n.length-1))}function p(e,n){var t=n.split("."),r=c(e,function(e){return d(e,t)});return e.listeners.push(function(e){r(d(e,t))}),r}function v(e,n){return Array.isArray(n)?e.map(function(e){return n.map(function(n){return d(e,n.split("."))})}):e.map(function(e){return d(e,n.split("."))})}function y(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(e,n){return o(e,n)},t=c(e,function(e){return e});return e.listeners.push(function(e){n(t.value,e)&&t(e)}),t}function m(e,n){return new Promise(function(t){e(null===n||"object"!==(void 0===n?"undefined":O(n))||"object"!==O(e.value)?n:Object.assign({},e.value,n)),t(e)})}function h(e,n){var t=x(),r=function(n,t){t(e.value),n.listeners.push(t)};return void 0===n.value&&r(e,t),n.map(function(n){n?j(e.listeners,t):r(e,t)}),t}function b(e,n,t){function r(){o=n(o,e.value),u(o)}var o=t,u=x();return void 0!==e.value&&r(e.value),e.listeners.push(r),u}function g(e,n){function t(e){r&&window.clearTimeout(r),r=setTimeout(function(){o(e),r=null},n)}var r,o=x();return void 0!==e.value&&t(e.value),e.listeners.push(t),o}function j(e,n){var t=e.indexOf(n);-1!==t&&e.splice(t,1)}Object.defineProperty(n,"__esModule",{value:!0}),n.stream=void 0;var O="function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)};n.merge$=function(e){var n=e.map(function(e){return e&&e.IS_STREAM?e.value:e}),t=x(-1===n.indexOf(void 0)?n:void 0);return e.forEach(function(e,r){e.IS_STREAM&&e.listeners.push(function(e){n[r]=e,t(-1===n.indexOf(void 0)?n:void 0)})}),t},n.isStream=function(e){return null!=e&&!!e.IS_STREAM};var S=t(5),_=function(e){return e&&e.__esModule?e:{default:e}}(S),x=n.stream=function(e){var n=function e(n){return void 0===n?e.value:(u(e,n),e)};return n.IS_STREAM=!0,n.value=e,n.listeners=[],n.map=function(e){return f(n,e)},n.is=function(e){return f(n,function(n){return n===e})},n.flatMap=function(e){return l(n,e)},n.filter=function(e){return s(n,e)},n.deepSelect=function(e){return p(n,e)},n.distinct=function(e){return y(n,e)},n.$=function(e){return v(n,e)},n.until=function(e){return h(n,e)},n.patch=function(e){return m(n,e)},n.reduce=function(e,t){return b(n,e,t)},n.debounce=function(e){return g(n,e)},n.log=function(){return a(n)},n}},function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0});var r=t(0);Object.keys(r).forEach(function(e){"default"===e||"__esModule"===e||Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var o=t(3);Object.keys(o).forEach(function(e){"default"===e||"__esModule"===e||Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})});var u=t(9);Object.keys(u).forEach(function(e){"default"===e||"__esModule"===e||Object.defineProperty(n,e,{enumerable:!0,get:function(){return u[e]}})});var i=t(8);Object.keys(i).forEach(function(e){"default"===e||"__esModule"===e||Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})})},function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0});var r=t(1);Object.keys(r).forEach(function(e){"default"===e||"__esModule"===e||Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}})});var o=t(4);Object.keys(o).forEach(function(e){"default"===e||"__esModule"===e||Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})})},function(e,n,t){function o(e,n,t,r){return n.props&&n.props.id?u(e,n,t,r):i(e,n,t,r)}function u(e,n,t,r){var o=n.tag,u=n.props,i=n.children,c=n.version,f=t.props,a=u.id,s=!1,p=!1;void 0===r[a]&&(r[a]={element:document.createElement(o),vdom:{tag:o,props:{},children:[]}},s=!0);var v=r[a];return c!==v.version&&(l(v.element,u,f),d(v.element,i,v.vdom.children,r),v.version=c,v.vdom.props=u,v.vdom.children=i,p=!0),s?m(v.element,u,"created"):p&&m(v.element,u,"updated"),e!==v.element&&(e.parentElement.replaceChild(v.element,e),m(v.element,u,"mounted")),v.element}function i(e,n,t,r){var o=n.tag,u=n.props,i=n.children,c=n.version,f=t.props,a=t.children;t.version;if(b(e)&&o===_)return g(e,i[0]),e;if(!1===j(e,u,o)){var s=v(o,i);e.parentElement.replaceChild(s,e),e=s,a=[]}return l(e,u,f),o!==_&&d(e,i,a,r),0===c&&m(e,u,"created"),0<c&&m(e,u,"updated"),e}function c(e,n,t){var r=e.childNodes.length;for(t.length!==r&&console.warn("ZLIQ: Something other then ZLIQ has manipulated the children of the element",e,". This can lead to sideffects. Please check your code.");r>n.length;r--){var o=e.childNodes[r-1];if(e.removeChild(o),!(t.length<r)){m(o,t[r-1].props,"removed")}}}function f(e,n,t,r){for(var u=e.childNodes,i=0;i<u.length&&i<n.length;i++)o(u[i],n[i],t[i],r)}function a(e,n,t){for(var r=e.childNodes.length;r<n.length;r++){var u=n[r],i=u.tag,c=u.props,f=u.children,a=(u.version,v(i,f));e.appendChild(a),o(a,n[r],{},t),c&&c.cycle&&c.cycle.mounted&&console.error("The 'mounted' lifecycle event is only called on elements with id. As elements are updated in place, it is hard to define when a normal element is mounted.")}}function l(e,n){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};void 0!==n&&(Object.keys(n).map(function(t){s(e,t,n[t])}),Object.keys(t).map(function(t){void 0===n[t]&&e.removeAttribute(t)}))}function s(e,n,t){if("class"===n||"className"===n)e.className=t||"";else if("style"===n&&"string"!=typeof t){var r=t?Object.keys(t).map(function(e){return e+":"+t[e]+";"}).join(" "):"";e.style.cssText=r}else e[n]=null===t?void 0:t}function d(e,n){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],r=arguments[3];if(0!==n.length||0!==t.length){var o=(e.childNodes,p(n));f(e,o,p(t),r),c(e,o,t),a(e,o,r)}}function p(e){return e.map(function(e){return(0,S.isStream)(e)||void 0!==e.tag?e:{tag:_,children:[e],version:0}})}function v(e,n){return e===_?document.createTextNode(n[0]):document.createElement(e)}function y(e){var n=JSON.parse(JSON.stringify(e));return n.forEach(function(n,t){var r=e[t];r.props&&r.props.cycle&&(n.cycle=r.props.cycle),"object"===O(e[t])&&(n.children=y(r.children))}),n}function m(e,n,t){n&&n.cycle&&n.cycle[t]&&n.cycle[t](e)}function h(e,n){return e.nodeName.toLowerCase()!==n}function b(e){return e instanceof window.Text}function g(e,n){e.nodeValue!==n&&(e.nodeValue=n)}function j(e,n,t){return!b(e)&&""===e.id&&!h(e,t)}Object.defineProperty(n,"__esModule",{value:!0});var O="function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)};n.render=function(e,n){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:10;return e.debounce(t).reduce(function(e,t){var r=e.element,u=e.version,i=e.children,c=e.keyContainer,f=t.tag,a=t.props,l=t.children,s=t.version;null===r&&(r=v(f,l),n&&n.appendChild(r));var d=o(r,{tag:f,props:a,children:l,version:s},{children:i,version:u},c);return n&&0===s&&m(r,a,"mounted"),{element:d,version:s,children:y(l),keyContainer:c}},{element:null,version:-1,children:[],keyContainer:{}})},n.diff=o,n.createNode=v;var S=t(0),_="#text"},function(e,n,t){function r(e,n,t){return e.reduce(function(e,r){return void 0===n[e]&&t.fail("Unexpected Update!"),o(n,e,r,t),e+1},0)}function o(e,n,t,r){setTimeout(function(){try{"function"==typeof e[n]?e[n](t):expect(t).toEqual(e[n])}catch(e){r.fail(e)}e.length===n+1&&r&&r()})}Object.defineProperty(n,"__esModule",{value:!0}),n.testRender=function(e,n,t){var o=3<arguments.length&&void 0!==arguments[3]&&arguments[3],i=document.createElement("div");return o&&document.body.appendChild(i),r((0,u.render)(e,i,0),n,t)},n.test$=r;var u=t(2)},function(e,n,t){function o(e){return null===e||void 0===e}function u(e){return e&&"object"===(void 0===e?"undefined":c(e))&&"number"==typeof e.length&&"function"==typeof e.copy&&"function"==typeof e.slice&&!(0<e.length&&"number"!=typeof e[0])}function i(e,n,t){var r,i;if(o(e)||o(n))return!1;if(e.prototype!==n.prototype)return!1;if(l(e))return!!l(n)&&(e=f.call(e),n=f.call(n),s(e,n,t));if(u(e)){if(!u(n))return!1;if(e.length!==n.length)return!1;for(r=0;r<e.length;r++)if(e[r]!==n[r])return!1;return!0}try{var d=a(e),p=a(n)}catch(e){return!1}if(d.length!=p.length)return!1;for(d.sort(),p.sort(),r=d.length-1;0<=r;r--)if(d[r]!=p[r])return!1;for(r=d.length-1;0<=r;r--)if(i=d[r],!s(e[i],n[i],t))return!1;return(void 0===e?"undefined":c(e))===(void 0===n?"undefined":c(n))}var c="function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)},f=Array.prototype.slice,a=t(7),l=t(6),s=e.exports=function(e,n,t){return t||(t={}),e===n||(e instanceof Date&&n instanceof Date?e.getTime()===n.getTime():e&&n&&("object"==(void 0===e?"undefined":c(e))||"object"==(void 0===n?"undefined":c(n)))?i(e,n,t):t.strict?e===n:e==n)}},function(e,n){function t(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function o(e){return e&&"object"==(void 0===e?"undefined":u(e))&&"number"==typeof e.length&&Object.prototype.hasOwnProperty.call(e,"callee")&&!Object.prototype.propertyIsEnumerable.call(e,"callee")||!1}var u="function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?function(e){return void 0===e?"undefined":r(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":r(e)},i="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();n=e.exports=i?t:o,n.supported=t,n.unsupported=o},function(e,n){function t(e){var n=[];for(var t in e)n.push(t);return n}n=e.exports="function"==typeof Object.keys?Object.keys:t,n.shim=t},function(e,n,t){Object.defineProperty(n,"__esModule",{value:!0}),n.promise$=void 0,n.if$=function(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;return void 0!==e&&(0,r.isStream)(e)?e.map(function(e){return e?n:t}):(0,r.stream)(e?n:t)},n.join$=function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];return(0,r.merge$)(n).map(function(e){return e.join(" ")})};var r=t(1);n.promise$=function(e){var n=(0,r.stream)({loading:!0,error:null,data:null});return e.then(function(e){n.patch({loading:!1,data:e})},function(e){n.patch({loading:!1,error:e})}),n}},function(e,n,t){function r(e){Array.isArray(e)||(e=[e]),e=o(e).filter(function(e){return null!==e});var n=e.map(function(e){return(0,f.isStream)(e)?e.flatMap(r):e});return(0,f.merge$)(n)}function o(e,n){var t,r=Object.prototype.toString,o=[],u=n&&e||e.slice();if(!e.length)return o;t=u.pop();do{"[object Array]"===r.call(t)?u.push.apply(u,t):o.push(t)}while(u.length&&void 0!==(t=u.pop()));return o.reverse(),o}function u(e){if(null===e)return(0,f.stream)({});var n=i(e),t=n.map(function(e){var n=e.parent,t=e.key;return e.stream.distinct().map(function(e){return n[t]=e,e})});return(0,f.merge$)(t).map(function(){return e})}function i(e){return o(Object.keys(e).map(function(n){return e[n]&&(0,f.isStream)(e[n])?[{parent:e,key:n,stream:e[n]}]:[]}))}Object.defineProperty(n,"__esModule",{value:!0}),n.h=void 0;var c=function(){function e(e,n){var t,r=[],o=!0,u=!1;try{for(var i,c=e[Symbol.iterator]();!((o=(i=c.next()).done)||(r.push(i.value),n&&r.length===n));o=!0);}catch(e){u=!0,t=e}finally{try{!o&&c.return&&c.return()}finally{if(u)throw t}}return r}return function(n,t){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return e(n,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();n.flatten=o;var f=t(0);t(3),n.h=function(e,n){for(var t=arguments.length,i=Array(2<t?t-2:0),a=2;a<t;a++)i[a-2]=arguments[a];var l=-1,s=r(o(i));return"function"==typeof e?e(n||{},s):(0,f.merge$)([u(n),s.map(o)]).map(function(n){var t=c(n,2),r=t[0],o=t[1];return{tag:e,props:r,children:o,version:++l}})}}])}])});